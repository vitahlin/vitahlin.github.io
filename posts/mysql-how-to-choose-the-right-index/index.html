<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="示例表 表结构 1 2 3 4 5 6 7 8 9 10 11 12 13  DROPTABLEIFEXISTSemployees;CREATETABLE`employees`(`id`int(11)NOTNULLAUTO_INCREMENT,`name`varchar(24)NOTNULLDEFAULT&amp;#39;&amp;#39;COMMENT&amp;#39;姓名&amp;#39;,`age`int(11)NOTNULLDEFAULT&amp;#39;0&amp;#39;COMMENT&amp;#39;年龄&amp;#39;,`position`varchar(20)NOTNULLDEFAULT&amp;#39;&amp;#39;COMMENT&amp;#39;职位&amp;#39;,`hire_time`timestampNOTNULLDEFAULTCURRENT_TIMESTAMPCOMMENT&amp;#39;入职时间&amp;#39;,PRIMARYKEY(`id`),KEY`idx_name_age_position`(`name`,`age`,`position`)USINGBTREE)ENGINE=InnoDBAUTO_INCREMENT=1DEFAULTCHARSET=utf8COMMENT=&amp;#39;员工记录表&amp;#39;;  测试数据 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22  INSERTINTOemployees(name,age,position,hire_time)VALUES(&amp;#39;LiLei&amp;#39;,22,&amp;#39;manager&amp;#39;,NOW());INSERTINTOemployees(name,age,position,hire_time)VALUES(&amp;#39;HanMeimei&amp;#39;,23,&amp;#39;dev&amp;#39;,NOW());INSERTINTOemployees(name,age,position,hire_time)VALUES(&amp;#39;Lucy&amp;#39;,23,&amp;#39;dev&amp;#39;,NOW());#插入一些示例数据dropprocedureifexistsinsert_emp;delimiter;;createprocedureinsert_emp()begindeclareiint;seti=1;while(i&amp;lt;=100000)doinsertintoemployees(name,age,position)values(CONCAT(&amp;#39;zhuge&amp;#39;,i),i,&amp;#39;dev&amp;#39;);seti=i+1;endwhile;end;;delimiter;callinsert_emp();  不同的索引选择 我们用一个查询语句来做示例，同样的查询条件，仅仅是查询参数的不同。
全表扫描示例 1 2 3 4  EXPLAINSELECT*FROMemployeesWHEREname&amp;gt;&amp;#39;a&amp;#39;;  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  [ { &amp;#34;id&amp;#34;: 1, &amp;#34;select_type&amp;#34;: &amp;#34;SIMPLE&amp;#34;, &amp;#34;table&amp;#34;: &amp;#34;employees&amp;#34;, &amp;#34;partitions&amp;#34;: null, &amp;#34;type&amp;#34;: &amp;#34;ALL&amp;#34;, &amp;#34;possible_keys&amp;#34;: &amp;#34;idx_name_age_position&amp;#34;, &amp;#34;key&amp;#34;: null, &amp;#34;key_len&amp;#34;: null, &amp;#34;ref&amp;#34;: null, &amp;#34;rows&amp;#34;: 100269, &amp;#34;filtered&amp;#34;: 50, &amp;#34;Extra&amp;#34;: &amp;#34;Using where&amp;#34; } ]   覆盖索引示例 1 2 3 4  EXPLAINSELECTname,age,positionFROMemployeesWHEREname&amp;gt;&amp;#39;a&amp;#39;;  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  [ { &amp;#34;id&amp;#34;: 1, &amp;#34;select_type&amp;#34;: &amp;#34;SIMPLE&amp;#34;, &amp;#34;table&amp;#34;: &amp;#34;employees&amp;#34;, &amp;#34;partitions&amp;#34;: null, &amp;#34;type&amp;#34;: &amp;#34;range&amp;#34;, &amp;#34;possible_keys&amp;#34;: &amp;#34;idx_name_age_position&amp;#34;, &amp;#34;key&amp;#34;: &amp;#34;idx_name_age_position&amp;#34;, &amp;#34;key_len&amp;#34;: &amp;#34;74&amp;#34;, &amp;#34;ref&amp;#34;: null, &amp;#34;rows&amp;#34;: 50134, &amp;#34;filtered&amp;#34;: 100, &amp;#34;Extra&amp;#34;: &amp;#34;Using where; Using index&amp;#34; } ]   走索引示例 1 2 3 4  EXPLAINSELECT*FROMemployeesWHEREname&amp;gt;&amp;#39;zzz&amp;#39;;  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  [ { &amp;#34;id&amp;#34;: 1, &amp;#34;select_type&amp;#34;: &amp;#34;SIMPLE&amp;#34;, &amp;#34;table&amp;#34;: &amp;#34;employees&amp;#34;, &amp;#34;partitions&amp;#34;: null, &amp;#34;type&amp;#34;: &amp;#34;range&amp;#34;, &amp;#34;possible_keys&amp;#34;: &amp;#34;idx_name_age_position&amp;#34;, &amp;#34;key&amp;#34;: &amp;#34;idx_name_age_position&amp;#34;, &amp;#34;key_len&amp;#34;: &amp;#34;74&amp;#34;, &amp;#34;ref&amp;#34;: null, &amp;#34;rows&amp;#34;: 1, &amp;#34;filtered&amp;#34;: 100, &amp;#34;Extra&amp;#34;: &amp;#34;Using index condition&amp;#34; } ]   可以看到，上述3种情况，mysql选择了不同的查询方案。 mysql最终选择是否走索引或者一张表涉及多个索引最终选择哪个索引，我们可以用trace工具来一查究竟。"><title>Mysql如何选择合适的索引</title><link rel=canonical href=https://www.vitahlin.com/posts/mysql-how-to-choose-the-right-index/><link rel=stylesheet href=/scss/style.min.450926226e724574a6b936335ea06111f8aeb253d932c86cb2cc807341cd2889.css><meta property="og:title" content="Mysql如何选择合适的索引"><meta property="og:description" content="示例表 表结构 1 2 3 4 5 6 7 8 9 10 11 12 13  DROPTABLEIFEXISTSemployees;CREATETABLE`employees`(`id`int(11)NOTNULLAUTO_INCREMENT,`name`varchar(24)NOTNULLDEFAULT&amp;#39;&amp;#39;COMMENT&amp;#39;姓名&amp;#39;,`age`int(11)NOTNULLDEFAULT&amp;#39;0&amp;#39;COMMENT&amp;#39;年龄&amp;#39;,`position`varchar(20)NOTNULLDEFAULT&amp;#39;&amp;#39;COMMENT&amp;#39;职位&amp;#39;,`hire_time`timestampNOTNULLDEFAULTCURRENT_TIMESTAMPCOMMENT&amp;#39;入职时间&amp;#39;,PRIMARYKEY(`id`),KEY`idx_name_age_position`(`name`,`age`,`position`)USINGBTREE)ENGINE=InnoDBAUTO_INCREMENT=1DEFAULTCHARSET=utf8COMMENT=&amp;#39;员工记录表&amp;#39;;  测试数据 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22  INSERTINTOemployees(name,age,position,hire_time)VALUES(&amp;#39;LiLei&amp;#39;,22,&amp;#39;manager&amp;#39;,NOW());INSERTINTOemployees(name,age,position,hire_time)VALUES(&amp;#39;HanMeimei&amp;#39;,23,&amp;#39;dev&amp;#39;,NOW());INSERTINTOemployees(name,age,position,hire_time)VALUES(&amp;#39;Lucy&amp;#39;,23,&amp;#39;dev&amp;#39;,NOW());#插入一些示例数据dropprocedureifexistsinsert_emp;delimiter;;createprocedureinsert_emp()begindeclareiint;seti=1;while(i&amp;lt;=100000)doinsertintoemployees(name,age,position)values(CONCAT(&amp;#39;zhuge&amp;#39;,i),i,&amp;#39;dev&amp;#39;);seti=i+1;endwhile;end;;delimiter;callinsert_emp();  不同的索引选择 我们用一个查询语句来做示例，同样的查询条件，仅仅是查询参数的不同。
全表扫描示例 1 2 3 4  EXPLAINSELECT*FROMemployeesWHEREname&amp;gt;&amp;#39;a&amp;#39;;  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  [ { &amp;#34;id&amp;#34;: 1, &amp;#34;select_type&amp;#34;: &amp;#34;SIMPLE&amp;#34;, &amp;#34;table&amp;#34;: &amp;#34;employees&amp;#34;, &amp;#34;partitions&amp;#34;: null, &amp;#34;type&amp;#34;: &amp;#34;ALL&amp;#34;, &amp;#34;possible_keys&amp;#34;: &amp;#34;idx_name_age_position&amp;#34;, &amp;#34;key&amp;#34;: null, &amp;#34;key_len&amp;#34;: null, &amp;#34;ref&amp;#34;: null, &amp;#34;rows&amp;#34;: 100269, &amp;#34;filtered&amp;#34;: 50, &amp;#34;Extra&amp;#34;: &amp;#34;Using where&amp;#34; } ]   覆盖索引示例 1 2 3 4  EXPLAINSELECTname,age,positionFROMemployeesWHEREname&amp;gt;&amp;#39;a&amp;#39;;  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  [ { &amp;#34;id&amp;#34;: 1, &amp;#34;select_type&amp;#34;: &amp;#34;SIMPLE&amp;#34;, &amp;#34;table&amp;#34;: &amp;#34;employees&amp;#34;, &amp;#34;partitions&amp;#34;: null, &amp;#34;type&amp;#34;: &amp;#34;range&amp;#34;, &amp;#34;possible_keys&amp;#34;: &amp;#34;idx_name_age_position&amp;#34;, &amp;#34;key&amp;#34;: &amp;#34;idx_name_age_position&amp;#34;, &amp;#34;key_len&amp;#34;: &amp;#34;74&amp;#34;, &amp;#34;ref&amp;#34;: null, &amp;#34;rows&amp;#34;: 50134, &amp;#34;filtered&amp;#34;: 100, &amp;#34;Extra&amp;#34;: &amp;#34;Using where; Using index&amp;#34; } ]   走索引示例 1 2 3 4  EXPLAINSELECT*FROMemployeesWHEREname&amp;gt;&amp;#39;zzz&amp;#39;;  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  [ { &amp;#34;id&amp;#34;: 1, &amp;#34;select_type&amp;#34;: &amp;#34;SIMPLE&amp;#34;, &amp;#34;table&amp;#34;: &amp;#34;employees&amp;#34;, &amp;#34;partitions&amp;#34;: null, &amp;#34;type&amp;#34;: &amp;#34;range&amp;#34;, &amp;#34;possible_keys&amp;#34;: &amp;#34;idx_name_age_position&amp;#34;, &amp;#34;key&amp;#34;: &amp;#34;idx_name_age_position&amp;#34;, &amp;#34;key_len&amp;#34;: &amp;#34;74&amp;#34;, &amp;#34;ref&amp;#34;: null, &amp;#34;rows&amp;#34;: 1, &amp;#34;filtered&amp;#34;: 100, &amp;#34;Extra&amp;#34;: &amp;#34;Using index condition&amp;#34; } ]   可以看到，上述3种情况，mysql选择了不同的查询方案。 mysql最终选择是否走索引或者一张表涉及多个索引最终选择哪个索引，我们可以用trace工具来一查究竟。"><meta property="og:url" content="https://www.vitahlin.com/posts/mysql-how-to-choose-the-right-index/"><meta property="og:site_name" content="Vitah Lin"><meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:tag" content="mysql"><meta property="article:tag" content="database"><meta property="article:published_time" content="2022-04-13T00:00:00+00:00"><meta property="article:modified_time" content="2022-04-13T00:00:00+00:00"><meta name=twitter:title content="Mysql如何选择合适的索引"><meta name=twitter:description content="示例表 表结构 1 2 3 4 5 6 7 8 9 10 11 12 13  DROPTABLEIFEXISTSemployees;CREATETABLE`employees`(`id`int(11)NOTNULLAUTO_INCREMENT,`name`varchar(24)NOTNULLDEFAULT&amp;#39;&amp;#39;COMMENT&amp;#39;姓名&amp;#39;,`age`int(11)NOTNULLDEFAULT&amp;#39;0&amp;#39;COMMENT&amp;#39;年龄&amp;#39;,`position`varchar(20)NOTNULLDEFAULT&amp;#39;&amp;#39;COMMENT&amp;#39;职位&amp;#39;,`hire_time`timestampNOTNULLDEFAULTCURRENT_TIMESTAMPCOMMENT&amp;#39;入职时间&amp;#39;,PRIMARYKEY(`id`),KEY`idx_name_age_position`(`name`,`age`,`position`)USINGBTREE)ENGINE=InnoDBAUTO_INCREMENT=1DEFAULTCHARSET=utf8COMMENT=&amp;#39;员工记录表&amp;#39;;  测试数据 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22  INSERTINTOemployees(name,age,position,hire_time)VALUES(&amp;#39;LiLei&amp;#39;,22,&amp;#39;manager&amp;#39;,NOW());INSERTINTOemployees(name,age,position,hire_time)VALUES(&amp;#39;HanMeimei&amp;#39;,23,&amp;#39;dev&amp;#39;,NOW());INSERTINTOemployees(name,age,position,hire_time)VALUES(&amp;#39;Lucy&amp;#39;,23,&amp;#39;dev&amp;#39;,NOW());#插入一些示例数据dropprocedureifexistsinsert_emp;delimiter;;createprocedureinsert_emp()begindeclareiint;seti=1;while(i&amp;lt;=100000)doinsertintoemployees(name,age,position)values(CONCAT(&amp;#39;zhuge&amp;#39;,i),i,&amp;#39;dev&amp;#39;);seti=i+1;endwhile;end;;delimiter;callinsert_emp();  不同的索引选择 我们用一个查询语句来做示例，同样的查询条件，仅仅是查询参数的不同。
全表扫描示例 1 2 3 4  EXPLAINSELECT*FROMemployeesWHEREname&amp;gt;&amp;#39;a&amp;#39;;  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  [ { &amp;#34;id&amp;#34;: 1, &amp;#34;select_type&amp;#34;: &amp;#34;SIMPLE&amp;#34;, &amp;#34;table&amp;#34;: &amp;#34;employees&amp;#34;, &amp;#34;partitions&amp;#34;: null, &amp;#34;type&amp;#34;: &amp;#34;ALL&amp;#34;, &amp;#34;possible_keys&amp;#34;: &amp;#34;idx_name_age_position&amp;#34;, &amp;#34;key&amp;#34;: null, &amp;#34;key_len&amp;#34;: null, &amp;#34;ref&amp;#34;: null, &amp;#34;rows&amp;#34;: 100269, &amp;#34;filtered&amp;#34;: 50, &amp;#34;Extra&amp;#34;: &amp;#34;Using where&amp;#34; } ]   覆盖索引示例 1 2 3 4  EXPLAINSELECTname,age,positionFROMemployeesWHEREname&amp;gt;&amp;#39;a&amp;#39;;  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  [ { &amp;#34;id&amp;#34;: 1, &amp;#34;select_type&amp;#34;: &amp;#34;SIMPLE&amp;#34;, &amp;#34;table&amp;#34;: &amp;#34;employees&amp;#34;, &amp;#34;partitions&amp;#34;: null, &amp;#34;type&amp;#34;: &amp;#34;range&amp;#34;, &amp;#34;possible_keys&amp;#34;: &amp;#34;idx_name_age_position&amp;#34;, &amp;#34;key&amp;#34;: &amp;#34;idx_name_age_position&amp;#34;, &amp;#34;key_len&amp;#34;: &amp;#34;74&amp;#34;, &amp;#34;ref&amp;#34;: null, &amp;#34;rows&amp;#34;: 50134, &amp;#34;filtered&amp;#34;: 100, &amp;#34;Extra&amp;#34;: &amp;#34;Using where; Using index&amp;#34; } ]   走索引示例 1 2 3 4  EXPLAINSELECT*FROMemployeesWHEREname&amp;gt;&amp;#39;zzz&amp;#39;;  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  [ { &amp;#34;id&amp;#34;: 1, &amp;#34;select_type&amp;#34;: &amp;#34;SIMPLE&amp;#34;, &amp;#34;table&amp;#34;: &amp;#34;employees&amp;#34;, &amp;#34;partitions&amp;#34;: null, &amp;#34;type&amp;#34;: &amp;#34;range&amp;#34;, &amp;#34;possible_keys&amp;#34;: &amp;#34;idx_name_age_position&amp;#34;, &amp;#34;key&amp;#34;: &amp;#34;idx_name_age_position&amp;#34;, &amp;#34;key_len&amp;#34;: &amp;#34;74&amp;#34;, &amp;#34;ref&amp;#34;: null, &amp;#34;rows&amp;#34;: 1, &amp;#34;filtered&amp;#34;: 100, &amp;#34;Extra&amp;#34;: &amp;#34;Using index condition&amp;#34; } ]   可以看到，上述3种情况，mysql选择了不同的查询方案。 mysql最终选择是否走索引或者一张表涉及多个索引最终选择哪个索引，我们可以用trace工具来一查究竟。"></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"light")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><div class=site-meta><h1 class=site-name><a href=/>Vitah Lin</a></h1><h2 class=site-description>深自缄默，如云漂泊</h2></div></header><ol class=social-menu><li><a href=https://github.com/vitahlin target=_blank title=GitHub><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>Home</span></a></li><li><a href=/about/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg><span>About</span></a></li><li><a href=/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg><span>Archives</span></a></li><li><a href=/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg><span>Search</span></a></li><li><a href=/links/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg><span>Links</span></a></li><div class=menu-bottom-section><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>Dark Mode</span></li></div></ol></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/mysql/>mysql</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/posts/mysql-how-to-choose-the-right-index/>Mysql如何选择合适的索引</a></h2></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>Apr 13, 2022</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>5 minute read</time></div></footer></div></header><section class=article-content><h2 id=示例表>示例表</h2><h3 id=表结构>表结构</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>DROP</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=k>IF</span><span class=w> </span><span class=k>EXISTS</span><span class=w> </span><span class=n>employees</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=o>`</span><span class=n>employees</span><span class=o>`</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=o>`</span><span class=n>id</span><span class=o>`</span><span class=w>        </span><span class=nb>int</span><span class=p>(</span><span class=mi>11</span><span class=p>)</span><span class=w>     </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=n>AUTO_INCREMENT</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=o>`</span><span class=n>name</span><span class=o>`</span><span class=w>      </span><span class=nb>varchar</span><span class=p>(</span><span class=mi>24</span><span class=p>)</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=s1>&#39;&#39;</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;姓名&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=o>`</span><span class=n>age</span><span class=o>`</span><span class=w>       </span><span class=nb>int</span><span class=p>(</span><span class=mi>11</span><span class=p>)</span><span class=w>     </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=s1>&#39;0&#39;</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;年龄&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=o>`</span><span class=k>position</span><span class=o>`</span><span class=w>  </span><span class=nb>varchar</span><span class=p>(</span><span class=mi>20</span><span class=p>)</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=s1>&#39;&#39;</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;职位&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=o>`</span><span class=n>hire_time</span><span class=o>`</span><span class=w> </span><span class=k>timestamp</span><span class=w>   </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=k>CURRENT_TIMESTAMP</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;入职时间&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=w> </span><span class=p>(</span><span class=o>`</span><span class=n>id</span><span class=o>`</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>KEY</span><span class=w> </span><span class=o>`</span><span class=n>idx_name_age_position</span><span class=o>`</span><span class=w> </span><span class=p>(</span><span class=o>`</span><span class=n>name</span><span class=o>`</span><span class=p>,</span><span class=w> </span><span class=o>`</span><span class=n>age</span><span class=o>`</span><span class=p>,</span><span class=w> </span><span class=o>`</span><span class=k>position</span><span class=o>`</span><span class=p>)</span><span class=w> </span><span class=k>USING</span><span class=w> </span><span class=n>BTREE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>)</span><span class=w> </span><span class=n>ENGINE</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>InnoDB</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>AUTO_INCREMENT</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>DEFAULT</span><span class=w> </span><span class=n>CHARSET</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>utf8</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=o>=</span><span class=s1>&#39;员工记录表&#39;</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=测试数据>测试数据</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>employees</span><span class=p>(</span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>age</span><span class=p>,</span><span class=w> </span><span class=k>position</span><span class=p>,</span><span class=w> </span><span class=n>hire_time</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;LiLei&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>22</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;manager&#39;</span><span class=p>,</span><span class=w> </span><span class=n>NOW</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>employees</span><span class=p>(</span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>age</span><span class=p>,</span><span class=w> </span><span class=k>position</span><span class=p>,</span><span class=w> </span><span class=n>hire_time</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;HanMeimei&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>23</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;dev&#39;</span><span class=p>,</span><span class=w> </span><span class=n>NOW</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>employees</span><span class=p>(</span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>age</span><span class=p>,</span><span class=w> </span><span class=k>position</span><span class=p>,</span><span class=w> </span><span class=n>hire_time</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;Lucy&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>23</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;dev&#39;</span><span class=p>,</span><span class=w> </span><span class=n>NOW</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>#</span><span class=w> </span><span class=err>插入一些示例数据</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>drop</span><span class=w> </span><span class=k>procedure</span><span class=w> </span><span class=k>if</span><span class=w> </span><span class=k>exists</span><span class=w> </span><span class=n>insert_emp</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>delimiter</span><span class=w> </span><span class=p>;;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>create</span><span class=w> </span><span class=k>procedure</span><span class=w> </span><span class=n>insert_emp</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>begin</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>declare</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=nb>int</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>set</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>while</span><span class=p>(</span><span class=n>i</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=mi>100000</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>do</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>insert</span><span class=w> </span><span class=k>into</span><span class=w> </span><span class=n>employees</span><span class=p>(</span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>age</span><span class=p>,</span><span class=w> </span><span class=k>position</span><span class=p>)</span><span class=w> </span><span class=k>values</span><span class=w> </span><span class=p>(</span><span class=n>CONCAT</span><span class=p>(</span><span class=s1>&#39;zhuge&#39;</span><span class=p>,</span><span class=w> </span><span class=n>i</span><span class=p>),</span><span class=w> </span><span class=n>i</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;dev&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>set</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>end</span><span class=w> </span><span class=n>while</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>end</span><span class=p>;;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>delimiter</span><span class=w> </span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>call</span><span class=w> </span><span class=n>insert_emp</span><span class=p>();</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h2 id=不同的索引选择>不同的索引选择</h2><p>我们用一个查询语句来做示例，同样的查询条件，仅仅是查询参数的不同。</p><h3 id=全表扫描示例>全表扫描示例</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>EXPLAIN</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=n>employees</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>WHERE</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=s1>&#39;a&#39;</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>[</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;id&#34;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;select_type&#34;</span><span class=p>:</span> <span class=s2>&#34;SIMPLE&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;table&#34;</span><span class=p>:</span> <span class=s2>&#34;employees&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;partitions&#34;</span><span class=p>:</span> <span class=kc>null</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;ALL&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;possible_keys&#34;</span><span class=p>:</span> <span class=s2>&#34;idx_name_age_position&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;key&#34;</span><span class=p>:</span> <span class=kc>null</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;key_len&#34;</span><span class=p>:</span> <span class=kc>null</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;ref&#34;</span><span class=p>:</span> <span class=kc>null</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;rows&#34;</span><span class=p>:</span> <span class=mi>100269</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;filtered&#34;</span><span class=p>:</span> <span class=mi>50</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;Extra&#34;</span><span class=p>:</span> <span class=s2>&#34;Using where&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=覆盖索引示例>覆盖索引示例</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>EXPLAIN</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>age</span><span class=p>,</span><span class=w> </span><span class=k>position</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=n>employees</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>WHERE</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=s1>&#39;a&#39;</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>[</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;id&#34;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;select_type&#34;</span><span class=p>:</span> <span class=s2>&#34;SIMPLE&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;table&#34;</span><span class=p>:</span> <span class=s2>&#34;employees&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;partitions&#34;</span><span class=p>:</span> <span class=kc>null</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;range&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;possible_keys&#34;</span><span class=p>:</span> <span class=s2>&#34;idx_name_age_position&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;key&#34;</span><span class=p>:</span> <span class=s2>&#34;idx_name_age_position&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;key_len&#34;</span><span class=p>:</span> <span class=s2>&#34;74&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;ref&#34;</span><span class=p>:</span> <span class=kc>null</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;rows&#34;</span><span class=p>:</span> <span class=mi>50134</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;filtered&#34;</span><span class=p>:</span> <span class=mi>100</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;Extra&#34;</span><span class=p>:</span> <span class=s2>&#34;Using where; Using index&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=走索引示例>走索引示例</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>EXPLAIN</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=n>employees</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>WHERE</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=s1>&#39;zzz&#39;</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>[</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;id&#34;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;select_type&#34;</span><span class=p>:</span> <span class=s2>&#34;SIMPLE&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;table&#34;</span><span class=p>:</span> <span class=s2>&#34;employees&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;partitions&#34;</span><span class=p>:</span> <span class=kc>null</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;range&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;possible_keys&#34;</span><span class=p>:</span> <span class=s2>&#34;idx_name_age_position&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;key&#34;</span><span class=p>:</span> <span class=s2>&#34;idx_name_age_position&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;key_len&#34;</span><span class=p>:</span> <span class=s2>&#34;74&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;ref&#34;</span><span class=p>:</span> <span class=kc>null</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;rows&#34;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;filtered&#34;</span><span class=p>:</span> <span class=mi>100</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;Extra&#34;</span><span class=p>:</span> <span class=s2>&#34;Using index condition&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><p>可以看到，上述3种情况，mysql选择了不同的查询方案。
mysql最终选择是否走索引或者一张表涉及多个索引最终选择哪个索引，我们可以用trace工具来一查究竟。</p><h2 id=trace介绍>trace介绍</h2><h3 id=用法>用法</h3><p>开启 trace 工具会影响 mysql 性能，所以只能临时分析 sql 使用，使用后应该立即关闭。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=o>#</span><span class=w> </span><span class=err>开启</span><span class=n>trace</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SET</span><span class=w> </span><span class=k>SESSION</span><span class=w> </span><span class=n>optimizer_trace</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&#34;enabled=on&#34;</span><span class=p>,</span><span class=n>end_markers_in_json</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>ON</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>#</span><span class=w> </span><span class=err>关闭</span><span class=w> </span><span class=n>trace</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SET</span><span class=w> </span><span class=k>SESSION</span><span class=w> </span><span class=n>optimizer_trace</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&#34;enabled=off&#34;</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>使用trace工具查看语句：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=n>employees</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>WHERE</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=s1>&#39;a&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>position</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=n>information_schema</span><span class=p>.</span><span class=n>optimizer_trace</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=结果分析>结果分析</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span><span class=lnt>156
</span><span class=lnt>157
</span><span class=lnt>158
</span><span class=lnt>159
</span><span class=lnt>160
</span><span class=lnt>161
</span><span class=lnt>162
</span><span class=lnt>163
</span><span class=lnt>164
</span><span class=lnt>165
</span><span class=lnt>166
</span><span class=lnt>167
</span><span class=lnt>168
</span><span class=lnt>169
</span><span class=lnt>170
</span><span class=lnt>171
</span><span class=lnt>172
</span><span class=lnt>173
</span><span class=lnt>174
</span><span class=lnt>175
</span><span class=lnt>176
</span><span class=lnt>177
</span><span class=lnt>178
</span><span class=lnt>179
</span><span class=lnt>180
</span><span class=lnt>181
</span><span class=lnt>182
</span><span class=lnt>183
</span><span class=lnt>184
</span><span class=lnt>185
</span><span class=lnt>186
</span><span class=lnt>187
</span><span class=lnt>188
</span><span class=lnt>189
</span><span class=lnt>190
</span><span class=lnt>191
</span><span class=lnt>192
</span><span class=lnt>193
</span><span class=lnt>194
</span><span class=lnt>195
</span><span class=lnt>196
</span><span class=lnt>197
</span><span class=lnt>198
</span><span class=lnt>199
</span><span class=lnt>200
</span><span class=lnt>201
</span><span class=lnt>202
</span><span class=lnt>203
</span><span class=lnt>204
</span><span class=lnt>205
</span><span class=lnt>206
</span><span class=lnt>207
</span><span class=lnt>208
</span><span class=lnt>209
</span><span class=lnt>210
</span><span class=lnt>211
</span><span class=lnt>212
</span><span class=lnt>213
</span><span class=lnt>214
</span><span class=lnt>215
</span><span class=lnt>216
</span><span class=lnt>217
</span><span class=lnt>218
</span><span class=lnt>219
</span><span class=lnt>220
</span><span class=lnt>221
</span><span class=lnt>222
</span><span class=lnt>223
</span><span class=lnt>224
</span><span class=lnt>225
</span><span class=lnt>226
</span><span class=lnt>227
</span><span class=lnt>228
</span><span class=lnt>229
</span><span class=lnt>230
</span><span class=lnt>231
</span><span class=lnt>232
</span><span class=lnt>233
</span><span class=lnt>234
</span><span class=lnt>235
</span><span class=lnt>236
</span><span class=lnt>237
</span><span class=lnt>238
</span><span class=lnt>239
</span><span class=lnt>240
</span><span class=lnt>241
</span><span class=lnt>242
</span><span class=lnt>243
</span><span class=lnt>244
</span><span class=lnt>245
</span><span class=lnt>246
</span><span class=lnt>247
</span><span class=lnt>248
</span><span class=lnt>249
</span><span class=lnt>250
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;steps&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=err>/*</span> <span class=err>第一阶段，sql准备阶段，格式化sql</span> <span class=err>*/</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;join_preparation&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;select#&#34;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;steps&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>          <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;expanded_query&#34;</span><span class=p>:</span> <span class=s2>&#34;/* select#1 */ select `employees`.`id` AS `id`,`employees`.`name` AS `name`,`employees`.`age` AS `age`,`employees`.`position` AS `position`,`employees`.`hire_time` AS `hire_time` from `employees` where (`employees`.`name` &gt; &#39;a&#39;) order by `employees`.`position`&#34;</span>
</span></span><span class=line><span class=cl>          <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>]</span> <span class=err>/*</span> <span class=err>steps</span> <span class=err>*/</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span> <span class=err>/*</span> <span class=err>join_preparation</span> <span class=err>*/</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=err>/*</span> <span class=err>第二阶段，sql优化阶段</span> <span class=err>*/</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;join_optimization&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;select#&#34;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;steps&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>          <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=err>/*</span> <span class=err>条件处理</span> <span class=err>*/</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;condition_processing&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>              <span class=nt>&#34;condition&#34;</span><span class=p>:</span> <span class=s2>&#34;WHERE&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>              <span class=nt>&#34;original_condition&#34;</span><span class=p>:</span> <span class=s2>&#34;(`employees`.`name` &gt; &#39;a&#39;)&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>              <span class=nt>&#34;steps&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span>
</span></span><span class=line><span class=cl>                  <span class=nt>&#34;transformation&#34;</span><span class=p>:</span> <span class=s2>&#34;equality_propagation&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                  <span class=nt>&#34;resulting_condition&#34;</span><span class=p>:</span> <span class=s2>&#34;(`employees`.`name` &gt; &#39;a&#39;)&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span>
</span></span><span class=line><span class=cl>                  <span class=nt>&#34;transformation&#34;</span><span class=p>:</span> <span class=s2>&#34;constant_propagation&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                  <span class=nt>&#34;resulting_condition&#34;</span><span class=p>:</span> <span class=s2>&#34;(`employees`.`name` &gt; &#39;a&#39;)&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span>
</span></span><span class=line><span class=cl>                  <span class=nt>&#34;transformation&#34;</span><span class=p>:</span> <span class=s2>&#34;trivial_condition_removal&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                  <span class=nt>&#34;resulting_condition&#34;</span><span class=p>:</span> <span class=s2>&#34;(`employees`.`name` &gt; &#39;a&#39;)&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>              <span class=p>]</span> <span class=err>/*</span> <span class=err>steps</span> <span class=err>*/</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span> <span class=err>/*</span> <span class=err>condition_processing</span> <span class=err>*/</span>
</span></span><span class=line><span class=cl>          <span class=p>},</span>
</span></span><span class=line><span class=cl>          <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;substitute_generated_columns&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span> <span class=err>/*</span> <span class=err>substitute_generated_columns</span> <span class=err>*/</span>
</span></span><span class=line><span class=cl>          <span class=p>},</span>
</span></span><span class=line><span class=cl>          <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=err>/*</span> <span class=err>表依赖详情</span> <span class=err>*/</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;table_dependencies&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>              <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;table&#34;</span><span class=p>:</span> <span class=s2>&#34;`employees`&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;row_may_be_null&#34;</span><span class=p>:</span> <span class=kc>false</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;map_bit&#34;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;depends_on_map_bits&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=p>]</span> <span class=err>/*</span> <span class=err>depends_on_map_bits</span> <span class=err>*/</span>
</span></span><span class=line><span class=cl>              <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>]</span> <span class=err>/*</span> <span class=err>table_dependencies</span> <span class=err>*/</span>
</span></span><span class=line><span class=cl>          <span class=p>},</span>
</span></span><span class=line><span class=cl>          <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;ref_optimizer_key_uses&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=p>]</span> <span class=err>/*</span> <span class=err>ref_optimizer_key_uses</span> <span class=err>*/</span>
</span></span><span class=line><span class=cl>          <span class=p>},</span>
</span></span><span class=line><span class=cl>          <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=err>/*</span> <span class=err>预估表的访问成本</span> <span class=err>*/</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;rows_estimation&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>              <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;table&#34;</span><span class=p>:</span> <span class=s2>&#34;`employees`&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;range_analysis&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                  <span class=err>/*</span> <span class=err>全表扫描情况</span> <span class=err>*/</span>
</span></span><span class=line><span class=cl>                  <span class=nt>&#34;table_scan&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=err>/*</span> <span class=err>扫描行数</span> <span class=err>*/</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;rows&#34;</span><span class=p>:</span> <span class=mi>100269</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>                    
</span></span><span class=line><span class=cl>                    <span class=err>/*</span> <span class=err>扫描成本</span> <span class=err>*/</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;cost&#34;</span><span class=p>:</span> <span class=mi>20345</span>
</span></span><span class=line><span class=cl>                  <span class=p>}</span> <span class=err>/*</span> <span class=err>table_scan</span> <span class=err>*/</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                  
</span></span><span class=line><span class=cl>                  <span class=err>/*</span> <span class=err>查询可能使用的索引</span> <span class=err>*/</span>
</span></span><span class=line><span class=cl>                  <span class=nt>&#34;potential_range_indexes&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                    <span class=p>{</span>
</span></span><span class=line><span class=cl>                      <span class=err>/*</span> <span class=err>主键索引</span> <span class=err>*/</span>
</span></span><span class=line><span class=cl>                      <span class=nt>&#34;index&#34;</span><span class=p>:</span> <span class=s2>&#34;PRIMARY&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                      <span class=nt>&#34;usable&#34;</span><span class=p>:</span> <span class=kc>false</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                      <span class=nt>&#34;cause&#34;</span><span class=p>:</span> <span class=s2>&#34;not_applicable&#34;</span>
</span></span><span class=line><span class=cl>                    <span class=p>},</span>
</span></span><span class=line><span class=cl>                    <span class=p>{</span>
</span></span><span class=line><span class=cl>                      <span class=err>/*</span> <span class=err>辅助索引</span> <span class=err>*/</span>
</span></span><span class=line><span class=cl>                      <span class=nt>&#34;index&#34;</span><span class=p>:</span> <span class=s2>&#34;idx_name_age_position&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                      <span class=nt>&#34;usable&#34;</span><span class=p>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                      <span class=nt>&#34;key_parts&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;name&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;age&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;position&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;id&#34;</span>
</span></span><span class=line><span class=cl>                      <span class=p>]</span> <span class=err>/*</span> <span class=err>key_parts</span> <span class=err>*/</span>
</span></span><span class=line><span class=cl>                    <span class=p>}</span>
</span></span><span class=line><span class=cl>                  <span class=p>]</span> <span class=err>/*</span> <span class=err>potential_range_indexes</span> <span class=err>*/</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                  <span class=nt>&#34;setup_range_conditions&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                  <span class=p>]</span> <span class=err>/*</span> <span class=err>setup_range_conditions</span> <span class=err>*/</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                  <span class=nt>&#34;group_index_range&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;chosen&#34;</span><span class=p>:</span> <span class=kc>false</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;cause&#34;</span><span class=p>:</span> <span class=s2>&#34;not_group_by_or_distinct&#34;</span>
</span></span><span class=line><span class=cl>                  <span class=p>}</span> <span class=err>/*</span> <span class=err>group_index_range</span> <span class=err>*/</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                  
</span></span><span class=line><span class=cl>                  <span class=err>/*</span> <span class=err>分析各个索引使用成本</span> <span class=err>*/</span>
</span></span><span class=line><span class=cl>                  <span class=nt>&#34;analyzing_range_alternatives&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;range_scan_alternatives&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                      <span class=p>{</span>
</span></span><span class=line><span class=cl>                        <span class=nt>&#34;index&#34;</span><span class=p>:</span> <span class=s2>&#34;idx_name_age_position&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        
</span></span><span class=line><span class=cl>                        <span class=err>/*</span> <span class=err>索引使用范围</span> <span class=err>*/</span>
</span></span><span class=line><span class=cl>                        <span class=nt>&#34;ranges&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                          <span class=s2>&#34;a &lt; name&#34;</span>
</span></span><span class=line><span class=cl>                        <span class=p>]</span> <span class=err>/*</span> <span class=err>ranges</span> <span class=err>*/</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=nt>&#34;index_dives_for_eq_ranges&#34;</span><span class=p>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        
</span></span><span class=line><span class=cl>                        <span class=err>/*</span> <span class=err>使用该索引获取的记录是否按照主键排序</span> <span class=err>*/</span>
</span></span><span class=line><span class=cl>                        <span class=nt>&#34;rowid_ordered&#34;</span><span class=p>:</span> <span class=kc>false</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=nt>&#34;using_mrr&#34;</span><span class=p>:</span> <span class=kc>false</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        
</span></span><span class=line><span class=cl>                        <span class=err>/*</span> <span class=err>是否使用覆盖索引</span> <span class=err>*/</span>
</span></span><span class=line><span class=cl>                        <span class=nt>&#34;index_only&#34;</span><span class=p>:</span> <span class=kc>false</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=err>/*</span> <span class=err>索引扫描行数</span> <span class=err>*/</span>
</span></span><span class=line><span class=cl>                        <span class=nt>&#34;rows&#34;</span><span class=p>:</span> <span class=mi>50134</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=err>/*</span> <span class=err>索引扫描成本</span> <span class=err>*/</span>
</span></span><span class=line><span class=cl>                        <span class=nt>&#34;cost&#34;</span><span class=p>:</span> <span class=mi>60162</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=err>/*</span> <span class=err>是否选择该索引</span> <span class=err>*/</span>
</span></span><span class=line><span class=cl>                        <span class=nt>&#34;chosen&#34;</span><span class=p>:</span> <span class=kc>false</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=nt>&#34;cause&#34;</span><span class=p>:</span> <span class=s2>&#34;cost&#34;</span>
</span></span><span class=line><span class=cl>                      <span class=p>}</span>
</span></span><span class=line><span class=cl>                    <span class=p>]</span> <span class=err>/*</span> <span class=err>range_scan_alternatives</span> <span class=err>*/</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;analyzing_roworder_intersect&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                      <span class=nt>&#34;usable&#34;</span><span class=p>:</span> <span class=kc>false</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                      <span class=nt>&#34;cause&#34;</span><span class=p>:</span> <span class=s2>&#34;too_few_roworder_scans&#34;</span>
</span></span><span class=line><span class=cl>                    <span class=p>}</span> <span class=err>/*</span> <span class=err>analyzing_roworder_intersect</span> <span class=err>*/</span>
</span></span><span class=line><span class=cl>                  <span class=p>}</span> <span class=err>/*</span> <span class=err>analyzing_range_alternatives</span> <span class=err>*/</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span> <span class=err>/*</span> <span class=err>range_analysis</span> <span class=err>*/</span>
</span></span><span class=line><span class=cl>              <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>]</span> <span class=err>/*</span> <span class=err>rows_estimation</span> <span class=err>*/</span>
</span></span><span class=line><span class=cl>          <span class=p>},</span>
</span></span><span class=line><span class=cl>          <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;considered_execution_plans&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>              <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;plan_prefix&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=p>]</span> <span class=err>/*</span> <span class=err>plan_prefix</span> <span class=err>*/</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;table&#34;</span><span class=p>:</span> <span class=s2>&#34;`employees`&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=err>/*</span> <span class=err>最优访问路径</span> <span class=err>*/</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;best_access_path&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                  <span class=err>/*</span> <span class=err>最终选择的访问路径</span> <span class=err>*/</span>
</span></span><span class=line><span class=cl>                  <span class=nt>&#34;considered_access_paths&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                    <span class=p>{</span>
</span></span><span class=line><span class=cl>                      <span class=nt>&#34;rows_to_scan&#34;</span><span class=p>:</span> <span class=mi>100269</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                      <span class=err>/*</span> <span class=err>访问类型，scan为全表扫描</span> <span class=err>*/</span>
</span></span><span class=line><span class=cl>                      <span class=nt>&#34;access_type&#34;</span><span class=p>:</span> <span class=s2>&#34;scan&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                      <span class=nt>&#34;resulting_rows&#34;</span><span class=p>:</span> <span class=mi>100269</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                      <span class=nt>&#34;cost&#34;</span><span class=p>:</span> <span class=mi>20343</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                      <span class=err>/*</span> <span class=err>是否选择：是</span> <span class=err>*/</span>
</span></span><span class=line><span class=cl>                      <span class=nt>&#34;chosen&#34;</span><span class=p>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                      <span class=nt>&#34;use_tmp_table&#34;</span><span class=p>:</span> <span class=kc>true</span>
</span></span><span class=line><span class=cl>                    <span class=p>}</span>
</span></span><span class=line><span class=cl>                  <span class=p>]</span> <span class=err>/*</span> <span class=err>considered_access_paths</span> <span class=err>*/</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span> <span class=err>/*</span> <span class=err>best_access_path</span> <span class=err>*/</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;condition_filtering_pct&#34;</span><span class=p>:</span> <span class=mi>100</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;rows_for_plan&#34;</span><span class=p>:</span> <span class=mi>100269</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;cost_for_plan&#34;</span><span class=p>:</span> <span class=mi>20343</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;sort_cost&#34;</span><span class=p>:</span> <span class=mi>100269</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;new_cost_for_plan&#34;</span><span class=p>:</span> <span class=mi>120612</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;chosen&#34;</span><span class=p>:</span> <span class=kc>true</span>
</span></span><span class=line><span class=cl>              <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>]</span> <span class=err>/*</span> <span class=err>considered_execution_plans</span> <span class=err>*/</span>
</span></span><span class=line><span class=cl>          <span class=p>},</span>
</span></span><span class=line><span class=cl>          <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;attaching_conditions_to_tables&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>              <span class=nt>&#34;original_condition&#34;</span><span class=p>:</span> <span class=s2>&#34;(`employees`.`name` &gt; &#39;a&#39;)&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>              <span class=nt>&#34;attached_conditions_computation&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>              <span class=p>]</span> <span class=err>/*</span> <span class=err>attached_conditions_computation</span> <span class=err>*/</span><span class=p>,</span>
</span></span><span class=line><span class=cl>              <span class=nt>&#34;attached_conditions_summary&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span>
</span></span><span class=line><span class=cl>                  <span class=nt>&#34;table&#34;</span><span class=p>:</span> <span class=s2>&#34;`employees`&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                  <span class=nt>&#34;attached&#34;</span><span class=p>:</span> <span class=s2>&#34;(`employees`.`name` &gt; &#39;a&#39;)&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>              <span class=p>]</span> <span class=err>/*</span> <span class=err>attached_conditions_summary</span> <span class=err>*/</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span> <span class=err>/*</span> <span class=err>attaching_conditions_to_tables</span> <span class=err>*/</span>
</span></span><span class=line><span class=cl>          <span class=p>},</span>
</span></span><span class=line><span class=cl>          <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;clause_processing&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>              <span class=nt>&#34;clause&#34;</span><span class=p>:</span> <span class=s2>&#34;ORDER BY&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>              <span class=nt>&#34;original_clause&#34;</span><span class=p>:</span> <span class=s2>&#34;`employees`.`position`&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>              <span class=nt>&#34;items&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span>
</span></span><span class=line><span class=cl>                  <span class=nt>&#34;item&#34;</span><span class=p>:</span> <span class=s2>&#34;`employees`.`position`&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>              <span class=p>]</span> <span class=err>/*</span> <span class=err>items</span> <span class=err>*/</span><span class=p>,</span>
</span></span><span class=line><span class=cl>              <span class=nt>&#34;resulting_clause_is_simple&#34;</span><span class=p>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>              <span class=nt>&#34;resulting_clause&#34;</span><span class=p>:</span> <span class=s2>&#34;`employees`.`position`&#34;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span> <span class=err>/*</span> <span class=err>clause_processing</span> <span class=err>*/</span>
</span></span><span class=line><span class=cl>          <span class=p>},</span>
</span></span><span class=line><span class=cl>          <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;reconsidering_access_paths_for_index_ordering&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>              <span class=nt>&#34;clause&#34;</span><span class=p>:</span> <span class=s2>&#34;ORDER BY&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>              <span class=nt>&#34;steps&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>              <span class=p>]</span> <span class=err>/*</span> <span class=err>steps</span> <span class=err>*/</span><span class=p>,</span>
</span></span><span class=line><span class=cl>              <span class=nt>&#34;index_order_summary&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;table&#34;</span><span class=p>:</span> <span class=s2>&#34;`employees`&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;index_provides_order&#34;</span><span class=p>:</span> <span class=kc>false</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;order_direction&#34;</span><span class=p>:</span> <span class=s2>&#34;undefined&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;index&#34;</span><span class=p>:</span> <span class=s2>&#34;unknown&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;plan_changed&#34;</span><span class=p>:</span> <span class=kc>false</span>
</span></span><span class=line><span class=cl>              <span class=p>}</span> <span class=err>/*</span> <span class=err>index_order_summary</span> <span class=err>*/</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span> <span class=err>/*</span> <span class=err>reconsidering_access_paths_for_index_ordering</span> <span class=err>*/</span>
</span></span><span class=line><span class=cl>          <span class=p>},</span>
</span></span><span class=line><span class=cl>          <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;refine_plan&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>              <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;table&#34;</span><span class=p>:</span> <span class=s2>&#34;`employees`&#34;</span>
</span></span><span class=line><span class=cl>              <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>]</span> <span class=err>/*</span> <span class=err>refine_plan</span> <span class=err>*/</span>
</span></span><span class=line><span class=cl>          <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>]</span> <span class=err>/*</span> <span class=err>steps</span> <span class=err>*/</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span> <span class=err>/*</span> <span class=err>join_optimization</span> <span class=err>*/</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=err>/*</span> <span class=err>第三阶段，sql执行阶段</span> <span class=err>*/</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;join_execution&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;select#&#34;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;steps&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>          <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;filesort_information&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>              <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;direction&#34;</span><span class=p>:</span> <span class=s2>&#34;asc&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;table&#34;</span><span class=p>:</span> <span class=s2>&#34;`employees`&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;field&#34;</span><span class=p>:</span> <span class=s2>&#34;position&#34;</span>
</span></span><span class=line><span class=cl>              <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>]</span> <span class=err>/*</span> <span class=err>filesort_information</span> <span class=err>*/</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;filesort_priority_queue_optimization&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>              <span class=nt>&#34;usable&#34;</span><span class=p>:</span> <span class=kc>false</span><span class=p>,</span>
</span></span><span class=line><span class=cl>              <span class=nt>&#34;cause&#34;</span><span class=p>:</span> <span class=s2>&#34;not applicable (no LIMIT)&#34;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span> <span class=err>/*</span> <span class=err>filesort_priority_queue_optimization</span> <span class=err>*/</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;filesort_execution&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=p>]</span> <span class=err>/*</span> <span class=err>filesort_execution</span> <span class=err>*/</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;filesort_summary&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>              <span class=nt>&#34;rows&#34;</span><span class=p>:</span> <span class=mi>100003</span><span class=p>,</span>
</span></span><span class=line><span class=cl>              <span class=nt>&#34;examined_rows&#34;</span><span class=p>:</span> <span class=mi>100003</span><span class=p>,</span>
</span></span><span class=line><span class=cl>              <span class=nt>&#34;number_of_tmp_files&#34;</span><span class=p>:</span> <span class=mi>30</span><span class=p>,</span>
</span></span><span class=line><span class=cl>              <span class=nt>&#34;sort_buffer_size&#34;</span><span class=p>:</span> <span class=mi>262056</span><span class=p>,</span>
</span></span><span class=line><span class=cl>              <span class=nt>&#34;sort_mode&#34;</span><span class=p>:</span> <span class=s2>&#34;&lt;sort_key, packed_additional_fields&gt;&#34;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span> <span class=err>/*</span> <span class=err>filesort_summary</span> <span class=err>*/</span>
</span></span><span class=line><span class=cl>          <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>]</span> <span class=err>/*</span> <span class=err>steps</span> <span class=err>*/</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span> <span class=err>/*</span> <span class=err>join_execution</span> <span class=err>*/</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>]</span> <span class=err>/*</span> <span class=err>steps</span> <span class=err>*/</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>上述 json 结果中给出大部分关键字段的注释，可以看到当前执行语句，mysql分析全表扫描比走索引查询的成本 cost 更低，所以选择了全表扫描。</p></section><footer class=article-footer><section class=article-tags><a href=/tags/mysql/>mysql</a>
<a href=/tags/database/>database</a></section><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span>Licensed under CC BY-NC-ND 4.0</span></section></footer><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css integrity=sha384-RZU/ijkSsFbcmivfdRBQDtwuwVqK7GMOw6IMvKyeWL2K5UAlyp6WonmB8m7Jd0Hn crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.js integrity=sha384-pK1WpvzWVBQiP0/GjnvRxV4mOb0oxFuyRxJlk6vVw146n3egcN5C925NCP7a7BY8 crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/auto-render.min.js integrity=sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl crossorigin=anonymous defer></script><script>window.addEventListener("DOMContentLoaded",()=>{renderMathInElement(document.querySelector(`.article-content`),{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}]})})</script></article><aside class=related-contents--wrapper><h2 class=section-title>Related contents</h2><div class=related-contents><div class="flex article-list--tile"><article><a href=/posts/instruction-of-mysql-explain/><div class=article-details><h2 class=article-title>Mysql explain命令介绍</h2></div></a></article><article><a href=/posts/mysql-indexing-optimization-practices/><div class=article-details><h2 class=article-title>Mysql索引优化实践</h2></div></a></article><article><a href=/posts/mysql-indexing-optimization-rules/><div class=article-details><h2 class=article-title>Mysql索引优化规则</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2022 Vitah Lin</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.11.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css integrity="sha256-c0uckgykQ9v5k+IqViZOZKc47Jn7KQil4/MP3ySA3F8=" crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE=" crossorigin=anonymous></main><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ul><li><a href=#示例表>示例表</a><ul><li><a href=#表结构>表结构</a></li><li><a href=#测试数据>测试数据</a></li></ul></li><li><a href=#不同的索引选择>不同的索引选择</a><ul><li><a href=#全表扫描示例>全表扫描示例</a></li><li><a href=#覆盖索引示例>覆盖索引示例</a></li><li><a href=#走索引示例>走索引示例</a></li></ul></li><li><a href=#trace介绍>trace介绍</a><ul><li><a href=#用法>用法</a></li><li><a href=#结果分析>结果分析</a></li></ul></li></ul></nav></div></section></aside></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>